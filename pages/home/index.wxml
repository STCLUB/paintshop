<nav nav-type="search" />

<view class="home-container">
  <view class="home-content">
    <t-pull-down-refresh
      value="{{enable}}"
      bind:refresh="onRefresh"
      loadingTexts="{{['下拉刷新', '松手刷新', '正在刷新', '刷新完成']}}"
    >
      <view class="home-card-list">
        <view 
          class="home-card" 
          wx:for="{{artworkList}}" 
          wx:key="id"
          data-id="{{item.id}}"
          bindtap="onArtworkClick"
        >
          <image class="home-card__image" src="{{item.images[0]}}" mode="aspectFill" />
          <view class="home-card__info">
            <text class="home-card__title">{{item.title}}</text>
            <view class="home-card__meta">
              <image class="author-avatar" src="{{item.author.avatar}}" />
              <text class="author-name">{{item.author.name}}</text>
            </view>
            <view class="home-card__tag-group" wx:if="{{item.tags && item.tags.length > 0}}">
              <t-tag 
                wx:for="{{item.tags}}" 
                wx:key="index" 
                size="small" 
                variant="light" 
                theme="{{index === 0 ? 'primary' : 'success'}}"
              >
                {{item}}
              </t-tag>
            </view>
          </view>
        </view>
      </view>

      <t-empty wx:if="{{!loading && artworkList.length === 0}}" description="暂无插画" />
      <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" text="加载中..." />
    </t-pull-down-refresh>
  </view>
</view>

<view class="home-publish" wx:if="{{isAdmin}}">
  <t-button theme="primary" size="large" icon="add" shape="round" bindtap="goPublish">
    发布
  </t-button>
</view>
<t-message id="t-message" />
